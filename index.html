<!DOCTYPE html>

<head>
	<title>qCloud</title>
	<style style="text/css">
		.centerBox {
			text-align: center;
			vertical-align: center;
			margin-top: 30%;
			padding-bottom: 10%;
		}
    </style>
</head>

<body>
	<div class="centerBox">
		<input autofocus="autofocus" type="text" id="inputField" style="font-size: 200%; width: 90%;" onkeypress="getInput(this)"><br>
		<p id="errorMessage" style="color: red"></p>
	</div>

	<script>
	var reservedWords = ["qubit", 'H', "pX", "pY", "pZ", "pShift", "read"];
	var xmlhttp = new XMLHttpRequest();
	var URL = "http://localhost:5000/";
	xmlhttp.onreadystatechange = function() {
		console.log("readyState = " + xmlhttp.readyState);
		console.log("status = " + xmlhttp.status);
		if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
			//reply = JSON.parse(xmlhttp.responseText);
			//if (reply == 1){
				//do stuff//
			//	console.log("success");
			//}
		}
	}

	function getInput(ele) {
		document.getElementById("errorMessage").innerHTML = "";
    	if(event.keyCode == 13) {
    		if (ele.value == "")
    			return;
        	var inputStr = ele.value;
        	ele.value = "";
        	if (validation(inputStr)) {
        		// Send data to server
        		xmlhttp.open("POST", URL, true);
        		xmlhttp.send(JSON.stringify(inputStr));
        		return;
        	}
        	//print out user error
        	document.getElementById("errorMessage").innerHTML = "Invalid Syntax";
        }        
    }

    function validation(str) {
    	var arr = str.split(' ');
    	if (reservedWords.indexOf(arr[0]) != -1) {
    		if (arr[0] == "pShift")
    			return (reservedWords.indexOf(arr[1]) == -1) && isNaN(parseFloat(arr[1])) && (/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/.test(arr[2]));
    		return (reservedWords.indexOf(arr[1]) == -1) &&  isNaN(parseFloat(arr[1]));
    	}
    	return false;
    }
	</script>
</body>
